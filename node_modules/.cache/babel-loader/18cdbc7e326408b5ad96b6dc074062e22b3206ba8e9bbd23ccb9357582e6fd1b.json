{"ast":null,"code":"import React,{useState,useRef,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import\"./prediction.scss\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Prediction=()=>{const[patientName,setPatientName]=useState(localStorage.getItem(\"patientName\")||\"\");const[age,setAge]=useState(localStorage.getItem(\"age\")||\"\");const[location,setLocation]=useState(localStorage.getItem(\"location\")||\"\");const[selectedFile,setSelectedFile]=useState(null);const[previewImage,setPreviewImage]=useState(null);const[predictionResult,setPredictionResult]=useState(null);const videoRef=useRef(null);const navigate=useNavigate();// Save input values to localStorage\nuseEffect(()=>{localStorage.setItem(\"patientName\",patientName);localStorage.setItem(\"age\",age);localStorage.setItem(\"location\",location);},[patientName,age,location]);// Image Upload\nconst handleImageUpload=event=>{const file=event.target.files[0];if(file){setSelectedFile(file);setPreviewImage(URL.createObjectURL(file));}};// Drag & Drop Handling\nconst handleDragOver=event=>event.preventDefault();const handleDrop=event=>{event.preventDefault();const file=event.dataTransfer.files[0];if(file){setSelectedFile(file);setPreviewImage(URL.createObjectURL(file));}};// Capture Image from Camera\nconst captureImage=()=>{const canvas=document.createElement(\"canvas\");const video=videoRef.current;if(video){canvas.width=video.videoWidth;canvas.height=video.videoHeight;const ctx=canvas.getContext(\"2d\");ctx.drawImage(video,0,0,canvas.width,canvas.height);canvas.toBlob(blob=>{setSelectedFile(blob);setPreviewImage(URL.createObjectURL(blob));},\"image/png\");}};// Send Image to Backend\nconst handlePrediction=async()=>{if(!selectedFile){alert(\"Please upload or capture an image first.\");return;}const formData=new FormData();formData.append(\"file\",selectedFile,\"image.png\");try{const response=await fetch(\"https://cardio-guard-backend.onrender.com/predict\",{method:\"POST\",body:formData});if(!response.ok){throw new Error(`Server Error: ${response.statusText}`);}const data=await response.json();if(!data.prediction){throw new Error(\"Invalid response from server.\");}setPredictionResult(`Prediction: ${data.prediction}`);navigate(\"/resultchatbot\",{state:{patientName,age,location,uploadedImage:previewImage,// Only pass uploaded image\npredictedCondition:data.prediction,// Prediction result\nannotatedImage:data.image?`${data.image}`:null// Annotated Image (if available)\n}});}catch(error){console.error(\"Error:\",error);alert(\"Error occurred. Please try again.\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"prediction-container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"title\",children:\"\\uD83D\\uDD0D MRI IMAGE PREDICTION\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"patient-details\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Name of the patient\",value:patientName,onChange:e=>setPatientName(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Age of the patient\",value:age,onChange:e=>setAge(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Location\",value:location,onChange:e=>setLocation(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-box\",onDragOver:handleDragOver,onDrop:handleDrop,children:[/*#__PURE__*/_jsx(\"p\",{children:\"Drag & Drop your MRI image here or\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleImageUpload,id:\"fileInput\",hidden:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",className:\"upload-btn\",children:\"Upload Image\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"camera-btn\",onClick:()=>videoRef.current.play(),children:\"\\uD83D\\uDCF7 Use Webcam\"}),videoRef.current&&/*#__PURE__*/_jsxs(\"div\",{className:\"camera-container\",children:[/*#__PURE__*/_jsx(\"video\",{ref:videoRef,autoPlay:true}),/*#__PURE__*/_jsx(\"button\",{className:\"capture-btn\",onClick:captureImage,children:\"Capture\"})]}),previewImage&&/*#__PURE__*/_jsxs(\"div\",{className:\"image-preview\",children:[/*#__PURE__*/_jsx(\"img\",{src:previewImage,alt:\"Selected\"}),/*#__PURE__*/_jsx(\"button\",{className:\"predict-btn\",onClick:handlePrediction,children:\"Predict\"})]})]});};export default Prediction;","map":{"version":3,"names":["React","useState","useRef","useEffect","useNavigate","jsx","_jsx","jsxs","_jsxs","Prediction","patientName","setPatientName","localStorage","getItem","age","setAge","location","setLocation","selectedFile","setSelectedFile","previewImage","setPreviewImage","predictionResult","setPredictionResult","videoRef","navigate","setItem","handleImageUpload","event","file","target","files","URL","createObjectURL","handleDragOver","preventDefault","handleDrop","dataTransfer","captureImage","canvas","document","createElement","video","current","width","videoWidth","height","videoHeight","ctx","getContext","drawImage","toBlob","blob","handlePrediction","alert","formData","FormData","append","response","fetch","method","body","ok","Error","statusText","data","json","prediction","state","uploadedImage","predictedCondition","annotatedImage","image","error","console","className","children","type","placeholder","value","onChange","e","onDragOver","onDrop","accept","id","hidden","htmlFor","onClick","play","ref","autoPlay","src","alt"],"sources":["/Users/akash/Documents/GitHub/AKASH-M-V-ML-PROJECTS/Cardio-Guard-Frontend/src/components/prediction/prediction.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport \"./prediction.scss\";\n\nconst Prediction = () => {\n    const [patientName, setPatientName] = useState(localStorage.getItem(\"patientName\") || \"\");\n    const [age, setAge] = useState(localStorage.getItem(\"age\") || \"\");\n    const [location, setLocation] = useState(localStorage.getItem(\"location\") || \"\");\n    const [selectedFile, setSelectedFile] = useState(null);\n    const [previewImage, setPreviewImage] = useState(null);\n    const [predictionResult, setPredictionResult] = useState(null);\n    const videoRef = useRef(null);\n    const navigate = useNavigate();\n\n    // Save input values to localStorage\n    useEffect(() => {\n        localStorage.setItem(\"patientName\", patientName);\n        localStorage.setItem(\"age\", age);\n        localStorage.setItem(\"location\", location);\n    }, [patientName, age, location]);\n\n    // Image Upload\n    const handleImageUpload = (event) => {\n        const file = event.target.files[0];\n        if (file) {\n            setSelectedFile(file);\n            setPreviewImage(URL.createObjectURL(file));\n        }\n    };\n\n    // Drag & Drop Handling\n    const handleDragOver = (event) => event.preventDefault();\n    const handleDrop = (event) => {\n        event.preventDefault();\n        const file = event.dataTransfer.files[0];\n        if (file) {\n            setSelectedFile(file);\n            setPreviewImage(URL.createObjectURL(file));\n        }\n    };\n\n    // Capture Image from Camera\n    const captureImage = () => {\n        const canvas = document.createElement(\"canvas\");\n        const video = videoRef.current;\n        if (video) {\n            canvas.width = video.videoWidth;\n            canvas.height = video.videoHeight;\n            const ctx = canvas.getContext(\"2d\");\n            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n            canvas.toBlob((blob) => {\n                setSelectedFile(blob);\n                setPreviewImage(URL.createObjectURL(blob));\n            }, \"image/png\");\n        }\n    };\n\n    // Send Image to Backend\n    const handlePrediction = async () => {\n        if (!selectedFile) {\n            alert(\"Please upload or capture an image first.\");\n            return;\n        }\n\n        const formData = new FormData();\n        formData.append(\"file\", selectedFile, \"image.png\");\n\n        try {\n            const response = await fetch(\"https://cardio-guard-backend.onrender.com/predict\", {\n                method: \"POST\",\n                body: formData,\n            });\n\n            if (!response.ok) {\n                throw new Error(`Server Error: ${response.statusText}`);\n            }\n\n            const data = await response.json();\n\n            if (!data.prediction) {\n                throw new Error(\"Invalid response from server.\");\n            }\n\n            setPredictionResult(`Prediction: ${data.prediction}`);\n\n            navigate(\"/resultchatbot\", {\n                state: {\n                    patientName,\n                    age,\n                    location,\n                    uploadedImage: previewImage, // Only pass uploaded image\n                    predictedCondition: data.prediction, // Prediction result\n                    annotatedImage: data.image ? `${data.image}` : null // Annotated Image (if available)\n                },\n            });\n            \n            \n        } catch (error) {\n            console.error(\"Error:\", error);\n            alert(\"Error occurred. Please try again.\");\n        }\n    };\n\n    return (\n        <div className=\"prediction-container\">\n            <h1 className=\"title\">üîç MRI IMAGE PREDICTION</h1>\n            \n            {/* Patient Details */}\n            <div className=\"patient-details\">\n                <input type=\"text\" placeholder=\"Name of the patient\" value={patientName} onChange={(e) => setPatientName(e.target.value)} />\n                <input type=\"number\" placeholder=\"Age of the patient\" value={age} onChange={(e) => setAge(e.target.value)} />\n                <input type=\"text\" placeholder=\"Location\" value={location} onChange={(e) => setLocation(e.target.value)} />\n            </div>\n\n            {/* Upload Section */}\n            <div className=\"upload-box\" onDragOver={handleDragOver} onDrop={handleDrop}>\n                <p>Drag & Drop your MRI image here or</p>\n                <input type=\"file\" accept=\"image/*\" onChange={handleImageUpload} id=\"fileInput\" hidden />\n                <label htmlFor=\"fileInput\" className=\"upload-btn\">Upload Image</label>\n            </div>\n\n            <button className=\"camera-btn\" onClick={() => videoRef.current.play()}>üì∑ Use Webcam</button>\n\n            {videoRef.current && (\n                <div className=\"camera-container\">\n                    <video ref={videoRef} autoPlay></video>\n                    <button className=\"capture-btn\" onClick={captureImage}>Capture</button>\n                </div>\n            )}\n\n            {previewImage && (\n                <div className=\"image-preview\">\n                    <img src={previewImage} alt=\"Selected\" />\n                    <button className=\"predict-btn\" onClick={handlePrediction}>Predict</button>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default Prediction;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}